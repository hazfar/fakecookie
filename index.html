<html>
<head>
	<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
</head>
<style type="text/css">
.img-container {
	width: 150px;
	height: 150px;
	/*position: relative;*/
}
.img-container > img {
	/*position: absolute;*/
	cursor: pointer;
	max-width: 100%;
	max-height: 100%;
	/*width: auto;
	height: auto;*/
}
</style>
<body>
	<div class="img-container">
		<img id="TheCookie" src="https://i.imgur.com/AhhFpo2.jpg" style="height: 100px;">
	</div>
	
	<!-- 縮成一行 -->
	<span id="Cinfo">點擊餅乾！每點一次你會得到 1 塊餅乾！</span>
	<span id="Ctimes">你現在有 0 塊餅乾！</span>
	
	<div class="img-container">	
		<img id="TheGranny" src="https://i.imgur.com/H1O8KaY.jpg" style="height: 100px;">
	</div>
	
	<!-- 縮成一行 -->
	<span>一個餅乾婆婆每 10 秒會幫你生產 1 塊餅乾！</span>
	<span id="Ginfo">你現在可以消耗 100 塊餅乾得到一個餅乾婆婆！</span>
	<span id="Gtimes">你現在有 0 個餅乾婆婆！每 10 秒會幫你生產 0 塊餅乾！</span>
	
	<div class="img-container">	
		<img id="TheMachine" src="https://i.imgur.com/GVyH10v.jpg" style="height: 100px;">
	</div>
	
	<!-- 縮成一行 -->
	<span>一個自動餅乾機器每 1 秒會幫你生產 1 塊餅乾！</span>
	<span id="Minfo">你可以消耗 1000 塊餅乾得到一個自動餅乾機器！</span>
	<span id="Mtimes">你現在有 0 個自動餅乾機器！每 1 秒會幫你生產 0 塊餅乾！</span>
	
	<!-- HTML的換行 -->
	<div class="img-container">	
		<img id="ThePortal" src="https://i.imgur.com/ZsMk8Vf.jpg" style="height: 100px;">
	</div>
	
	<!-- 縮成一行 -->
	<span>一個神秘餅乾傳送門每 1 秒會幫你生產 10 塊餅乾！</span>
	<span id="Pinfo">你可以消耗 5000 塊餅乾得到一個神秘餅乾傳送門！</span>
	<span id="Ptimes">你現在有 0 個神秘餅乾傳送門！每 1 秒會幫你生產 0 塊餅乾！</span>

</body>
<script type="text/javascript">

	var factoryArray = [
			{
				id: 'TheCookie',
				cost: 0,//原本用-1有問題 每次點擊變成兩塊餅乾
				amount: 0,
				production: 0,
				time: 1000000000000000,
				lalala: "Ctimes",
				info: "Cinfo",
				fufufu: "塊餅乾！",
			},
			{
				id: 'TheGranny',
				cost: 100,
				amount: 0,
				production: 1,
				time: 10000,
				lalala: "Gtimes",
				info: "Ginfo",
				fufufu: "個餅乾婆婆！",
			},
			{
				id: 'TheMachine',
				cost: 1000,
				amount: 0,
				production: 1,
				time: 1000,
				lalala: "Mtimes",
				info: "Minfo",
				fufufu: "個自動餅乾機器！",
			},
			{
				id: 'ThePortal',
				cost: 5000,
				amount: 0,
				production: 10,
				time: 1000,
				lalala: "Ptimes",
				info: "Pinfo",
				fufufu: "個神秘餅乾傳送門！",
			},
		];

	/* 筆記
	
	存特定字串：
	localStorage.<變數名> = <數值(字串)>
	localStorage['<變數名>'] = <數值(字串)>

	ex.
	localStorage.cookie = '123456'

	JSON：
	物件轉字串
	JSON.stringify( <物件> )

	字串轉物件
	JSON.parse( <字串> )

	*/

	/*
	作業：
	1. 縮減行數
	2. 重複事件改進 function
	3. 存檔讀檔
	4. 計時器改成一個
	5. 換圖片(?)

	*/

	function updateCookie(amount = 0) {
		factoryArray[0].amount += amount
		document.getElementById(factoryArray[0].lalala).innerText = `你現在有 ${ factoryArray[0].amount } ${ factoryArray[0].fufufu }`
	}

	function cookieAdder(amount, time) {
		updateCookie(amount)
		submitAdder(amount, time)
	}

	function submitAdder(amount, time) {
		setTimeout(cookieAdder, time, amount, time);
	}

	//新 function 用來改文字

	for (let i = 0; i < factoryArray.length; i++) {

		document.getElementById(factoryArray[i].id).addEventListener('click', function(e){

			if(factoryArray[i].cost <= factoryArray[0].amount){

				factoryArray[i].amount++;

				submitAdder(factoryArray[i].production , factoryArray[i].time)
				// submitAdder(factoryArray[i].amount * factoryArray[i].production, factoryArray[i].time)

				updateCookie( - factoryArray[i].cost )
				// factoryArray[0].amount -= factoryArray[i].cost;
				// document.getElementById(factoryArray[0].lalala).innerText = factoryArray[0].amount
				factoryArray[i].cost += factoryArray[i].cost * 0.01 | 0;
			}

			if( i > 0){

				//改進新 function

				document.getElementById(factoryArray[i].lalala).innerText = `你現在有 ${ factoryArray[i].amount } ${ factoryArray[i].fufufu }每 ${ factoryArray[i].time / 1000 } 秒會幫你生產 ${ factoryArray[i].amount * factoryArray[i].production } 塊餅乾！`
				document.getElementById(factoryArray[i].info).innerText = `你現在可以消耗 ${ factoryArray[i].cost } 塊餅乾得到一${ factoryArray[i].fufufu }`
			}

		})


	}
</script>
</html>